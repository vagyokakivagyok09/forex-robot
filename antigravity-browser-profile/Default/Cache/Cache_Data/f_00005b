"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){function e(i){var s={betradarLink:{},eventPageLink:{},eventResultsScoreboard:{},remainingTime:{},outcomes:{},custombetLink:{}};return s.betradarLink.isActive=function(e){return!(""===e.betradarId||0===e.betradarId)},s.betradarLink.getUrl=function(e,t){return e.isOutright?t.split("&")[0]:t+e.betradarId},s.custombetLink.isActive=function(e){return e.isCustomBet||!1},s.eventPageLink.hasMarketWithVisibleOdds=function(e){return!!(e.markets&&e.markets.length&&e.markets[0].outcomeCount<=3)},s.eventPageLink.hasVisibleMarket=function(e){return e.hasVisiblePrematchMarket||e.hasVisibleLiveMarket},s.eventPageLink.getRemainingCount=function(e){var t=0;return e.isLive?(t=e.remainingLiveMarketCount,null===e.markets||0===e.markets.length||e.markets[0].mainMarket||t++):t=e.remainingPrematchMarketCount,t},s.outcomes.hasVisibleMarket=function(e){return e.isOutright||null===e.markets||0===e.markets.length},s.outcomes.hasMainMarket=function(e){return e.isLive&&!e.markets[0].mainMarket},s.remainingTime.getTimes=function(e,t){var e=Date.parse(e),n=Date.parse(t),t=(isNaN(n)&&(n=i("date")(t,"yyyy-MM-ddTHH:mm:ssZ"),n=Date.parse(n.substr(0,n.length-2)+":"+n.substr(-2,2))),e/1e3-n/1e3);return{hour:parseInt(t/3600),minute:parseInt(t%3600/60)}},s.eventResultsScoreboard.getScoreboard=function(e,t,n){var i="";if("C"!==t[0].scoreTypeName){for(var o=t.length,a=0,r=-1;o--;){if("WO"===t[o].scoreTypeName){i="";break}"FT"===t[o].scoreTypeName?a=o:3!==e.sportId&&2!==e.sportId||"OT"!==t[o].scoreTypeName||(r=o)}-1===o&&(-1===r?i=t[a].scoreParticipant1+" - "+t[a].scoreParticipant2:(2===e.sportId&&(i+=t[a].scoreParticipant1+" - "+t[a].scoreParticipant2+", "+n.ot+" "),i+=t[r].scoreParticipant1+" - "+t[r].scoreParticipant2))}return i},s.eventIsHDA=function(e){return!(s.outcomes.hasVisibleMarket(e)||s.outcomes.hasMainMarket(e)||!angular.isArray(e.markets)||!angular.isArray(e.markets[0].outcomes)||3!==e.markets[0].outcomes.length)},s.hasMixedOutcomeEvents=function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i.events)for(var o=0,a=i.events.length;o<a;o++){var r=i.events[o];s.eventIsHDA(r)&&(i.hasMixedOutcomeEvents=!0)}else if(s.eventIsHDA(i))return!0}return!1},s.getCompetitionsNames=function(e){var t=[];return e.competitions&&e.competitions.length?e.competitions.forEach(function(e){t.push(e.name)}):t.push(e.competitionName),t},s}e.$inject=["$filter"],angular.module("tippmixUtilities",[]).factory("tippmixUtilities",e)}(),function(m,o,t){function e(l,d,u,a,c){var e={},r={};return e.async=function(e,t,n,i){var o,a=u.defer(),r=l.apiUri+e;if(i=i||"POST",n&&(r=e),t?m.isString(t)&&(t=c.$eval(t)):t={},t.parse){if(t.parse.int)for(o=t.parse.int.length;o--;)t[t.parse.int[o]]=parseInt(t[t.parse.int[o]]);if(t.parse.date)for(o=t.parse.date.length;o--;){var s=t[t.parse.date[o]];null!==/^\d{4}-\d{2}-\d{2}$/.exec(s)&&(s+="T00:00Z"),t[t.parse.date[o]]=new Date(s)}delete t.parse}return d({method:i,url:r,data:JSON.stringify(t),cache:!1,timeout:4e4}).success(function(e){e.error?a.reject(e.code,e.error):a.resolve(e)}).error(function(){a.reject("Error")}),a.promise},e.asyncWithjQuery=function(e,t,n,i){t=t||{},(n=n||!1)&&(t=m.extend({},t,l.csrf));n={dataType:"json",type:"POST",url:e,data:i?JSON.stringify(t):t};return i&&(n.contentType="application/json"),o.ajax(n)},e.startPolling=function(i,t,o){var e=this;r[i.name]?(r[i.name].data=i,r[i.name].successCallback=t,r[i.name].errorCallback=o):r[i.name]={data:i,successCallback:t,errorCallback:o},function n(){e.async(i.url,i.params,i.noApiUri,i.method).then(function(e){"function"==typeof t&&t(e),r[i.name].promise&&a.cancel(r[i.name].promise),r[i.name].promise=a(n,i.pollingTime)},function(e,t){"function"==typeof o&&o(e,t),r[i.name].promise&&a.cancel(r[i.name].promise),r[i.name].promise=a(n,i.pollingTime)})}()},e.stopPolling=function(e,t){r[e]&&(t=t||!0,a.cancel(r[e].promise),t&&delete r[e])},e.resumePolling=function(e){e=r[e];e!==t&&this.startPolling(e.data,e.successCallback,e.errorCallback)},e}e.$inject=["settings","$http","$q","$timeout","$rootScope"],m.module("tippmixHttp",[]).value("settings",{apiUri:""}).factory("httpService",e)}(angular,jQuery,void 0),angular.module("tippmixBetslipDirectives",[]),angular.module("tippmixBetslipFilters",[]),angular.module("tippmixBetslipServices",[]),angular.module("tippmixBetslip",["tippmixBetslipDirectives","tippmixBetslipFilters","tippmixBetslipServices"]).value("settings",{homePageUrl:""}),angular.module("tippmixBetslipFilters").filter("orderBetslipCombination",function(){return function(e){var t,n,i=[],o=[];for(t in e.single&&o.push(e.single),e)"single"!==t&&(n=parseInt(t),isNaN(n)||(o[n]=e[t]));for(var a=0,r=o.length;a<r;a++)o[a]&&i.push(o[a]);return i}}),angular.module("tippmixBetslipFilters").filter("filterBetslipItem",function(){return function(e,t,n){return e?n?Array.isArray(t)?e.filter(function(e){return-1===t.indexOf(e.sortId)}):e.filter(function(e){return e.sortId!==t}):e.filter(function(e){return e.sortId===t}):[]}}),angular.module("tippmixBetslipFilters").filter("orderBetslipItem",function(){return function(e){var t,n,i=[];for(t in e)(n=e[t]).id=t,i.push(n);return i=i.sort(function(e,t){return e.addToBetslip-t.addToBetslip})}}),function(){function e(e,t,n){var i=e("currency"),o=t.NUMBER_FORMATS;return function(e,t){return void 0===e?"":(void 0===t&&(t=n.prizeAmountRoundingValue%100==0?0:2),i(e,o.CURRENCY_SYM,t))}}e.$inject=["$filter","$locale","betslipSettings"],angular.module("tippmixBetslipFilters").filter("roundedCurrency",e)}(),angular.module("tippmixBetslipServices").factory("betslipSettings",function(){var t={set:function(e){t=angular.extend(t,e)}};return t}),function(){function e(u){var c={},d={},l={};return c.kCombinations=function(e,t){var n,i,o,a,r;if(t>e.length||t<=0)return[];if(t===e.length)return[e];if(1===t){for(o=[],n=0;n<e.length;n++)o.push([e[n]]);return o}for(o=[],n=0;n<e.length-t+1;n++)for(a=e.slice(n,n+1),r=this.kCombinations(e.slice(n+1),t-1),i=0;i<r.length;i++)o.push(a.concat(r[i]));return o},c.validateCombinationByClosedCombination=function(e){for(var t=0,n=e.length;t<n;t++)for(var i=0,o=e.length;i<o;i++)if(t!==i&&-1!==e[t].combinationBanKeys.indexOf(e[i].id))return!1;return!0},c.validateCombinationByBanker=function(e,t){if(0===t)return!0;for(var n=0,i=0,o=e.length;i<o;i++)e[i].bankerSelection&&n++;return t===n},c.filteredKCombinations=function(e,t,n){for(var i=this.kCombinations(e,t),o=[],a=0,r=i.length;a<r;a++){var s=i[a];this.validateCombinationByClosedCombination(s)&&this.validateCombinationByBanker(s,n)&&o.push(s)}return o},c.choose=function(e,t){return 0===t?1:e*this.choose(e-1,t-1)/t},c.calculateKSlashNCombination=function(e,t,n){for(var i,o=this.kCombinations(e,t),a=0,r=[],s=0;s<o.length;s++){for(var l=1,d=0;d<o[s].length;d++)l*=o[s][d].fixedOdds;i=u.rounding(l*n,1),r.push(i),a+=i}return{subExpectedPrizes:r,totalExpectedPrize:a}},c.calculateFilteredKSlashNCombination=function(e,t){for(var n,i=0,o=[],a=[],r=0;r<e.length;r++){for(var s=1,l=0;l<e[r].length;l++){s*=e[r][l].fixedOdds;var d=e[r][l].eventId+"-"+e[r][l].marketId+"-"+e[r][l].outcomeNo;-1===a.indexOf(d)&&a.push(d)}n=u.rounding(s*t,1),o.push(n),i+=n}return{subExpectedPrizes:o,totalExpectedPrize:i,multipleItems:a}},c.calculateNCombination=function(e,t){for(var n=1,i=[],o=0,a=e.length;o<a;o++)n*=e[o].fixedOdds;return t=u.rounding(n*t,1),i.push(t),{subExpectedPrizes:i,totalExpectedPrize:t}},c.calculateSingleCombination=function(e,t){for(var n,i=0,o=[],a=0,r=e.length;a<r;a++)e[a].minCombiCount<=1&&(n=u.rounding(e[a].fixedOdds*t,1),o.push(n),i+=n);return{subExpectedPrizes:o,totalExpectedPrize:i}},d.singleCombination=function(e,n){var t,i,o=0;angular.forEach(n.multipleBetslip,function(e){e.minCombiCount<=1&&o++}),0!==o&&(t="",angular.isDefined(n.data.multiple.single)&&(t=n.data.multiple.single.stake),i=!1,angular.isDefined(n.data.multiple.single)&&(i=n.data.multiple.single.selected),e.single={sortId:1,title:CONSTS.BETSLIP.SINGLE.TITLE,details:CONSTS.BETSLIP.SINGLE.DETAILS,unitCount:o,stake:t,selected:i,calculator:function(){var e={},t=c.calculateSingleCombination(n.multipleBetslip,this.stake);return e.subExpectedPrizes=t.subExpectedPrizes,e.expectedPrize=t.totalExpectedPrize,e.totalStake=this.unitCount*this.stake,e}})},d.nCombination=function(e,n){var t=n.multipleBetslip.length+"/"+n.multipleBetslip.length,i="",o=(angular.isDefined(n.data.multiple[t])&&(i=n.data.multiple[t].stake),!1),a=(angular.isDefined(n.data.multiple[t])&&(o=n.data.multiple[t].selected),CONSTS.BETSLIP.N.TITLE[n.multipleBetslip.length-1]+CONSTS.BETSLIP.N.TITLE[0]);e[t]={sortId:10,title:a,details:CONSTS.BETSLIP.N.DETAILS,unitCount:CONSTS.BETSLIP.N.UNIT_COUNT,stake:i,selected:o,calculator:function(){var e={},t=c.calculateNCombination(n.multipleBetslip,this.stake);return e.subExpectedPrizes=t.subExpectedPrizes,e.expectedPrize=t.totalExpectedPrize,e.totalStake=this.unitCount*this.stake,e}}},d.kSlashNCombination=function(e,i){var t=i.multipleBetslip.length;for(var n=1===i.minCombiCount?2:i.minCombiCount,o=i.maxCombiCount<t?i.maxCombiCount+1:t;n<o;n++){var a,r,s=n+"/"+t;-1===l.ignoreKSlashNCombinations.indexOf(s)&&(a="",angular.isDefined(i.data.multiple[s])&&(a=i.data.multiple[s].stake),r=!1,angular.isDefined(i.data.multiple[s])&&(r=i.data.multiple[s].selected),e[s]={sortId:20,title:CONSTS.BETSLIP.K_SLASH_N.TITLE.replace(/{n}/g,t).replace(/{k}/g,n),details:CONSTS.BETSLIP.K_SLASH_N.DETAILS.replace(/{n}/g,t).replace(/{k}/g,n),unitCount:c.choose(t,n),stake:a,selected:r,calculator:function(n){return function(){var e={},t=c.calculateKSlashNCombination(i.multipleBetslip,n,this.stake);return e.subExpectedPrizes=t.subExpectedPrizes,e.expectedPrize=t.totalExpectedPrize,e.totalStake=this.unitCount*this.stake,e}}(n)})}},d.specialCombination=function(e,r){var t=CONSTS.BETSLIP[r.combinationName].ID,s=-1!==r.specialWithSimple.indexOf(r.combinationName)&&1===r.minCombiCount,l=1===r.minCombiCount?2:r.minCombiCount,d=r.maxCombiCount<r.multipleBetslip.length?r.maxCombiCount:r.multipleBetslip.length,n=CONSTS.BETSLIP[r.combinationName].UNIT_COUNT,u={};if(r.isExistsCombinationBanItem||r.isExistsCombinationCountBanItem){n=0,s&&(n+=r.multipleBetslip.length);for(var i=l,o=d;i<=o;i++)u[i]=c.filteredKCombinations(r.multipleBetslip,i,0),n+=u[i].length}e[t]={sortId:30,title:CONSTS.BETSLIP[r.combinationName].TITLE,details:CONSTS.BETSLIP[r.combinationName].DETAILS,unitCount:n,stake:angular.isDefined(r.data.multiple[t])?r.data.multiple[t].stake:"",selected:!!angular.isDefined(r.data.multiple[t])&&r.data.multiple[t].selected,calculator:function(){var e,t={},n=[],i=0;if(r.isExistsCombinationBanItem||r.isExistsCombinationCountBanItem)for(var o=l,a=d;o<=a;o++)e=c.calculateFilteredKSlashNCombination(u[o],this.stake),n=n.concat(e.subExpectedPrizes),i+=e.totalExpectedPrize;else for(o=2,a=r.multipleBetslip.length;o<a;o++)e=c.calculateKSlashNCombination(r.multipleBetslip,o,this.stake),n=n.concat(e.subExpectedPrizes),i+=e.totalExpectedPrize;return s&&(e=c.calculateSingleCombination(r.multipleBetslip,this.stake),n=n.concat(e.subExpectedPrizes),i+=e.totalExpectedPrize),r.isExistsCombinationBanItem||r.isExistsCombinationCountBanItem||(e=c.calculateNCombination(r.multipleBetslip,this.stake),n=n.concat(e.subExpectedPrizes),i+=e.totalExpectedPrize),t.subExpectedPrizes=n,t.expectedPrize=i,t.totalStake=this.unitCount*this.stake,t}}},d.filteredKSlashNCombination=function(e,t){var n=t.multipleBetslip.length;for(var i=1===t.minCombiCount?2:t.minCombiCount,o=t.maxCombiCount<t.multipleBetslip.length?t.maxCombiCount:t.multipleBetslip.length-1;i<=o;i++){var a,r=i+"/"+n;-1===l.ignoreKSlashNCombinations.indexOf(r)&&(0<(a=c.filteredKCombinations(t.multipleBetslip,i,t.bankerSelectedItemLength)).length&&(e[r]={sortId:20,title:CONSTS.BETSLIP.K_SLASH_N.TITLE.replace(/{n}/g,n).replace(/{k}/g,i),details:CONSTS.BETSLIP.K_SLASH_N.DETAILS.replace(/{n}/g,n).replace(/{k}/g,i),unitCount:a.length,stake:angular.isDefined(t.data.multiple[r])?t.data.multiple[r].stake:"",selected:!!angular.isDefined(t.data.multiple[r])&&t.data.multiple[r].selected,calculator:function(n){return function(){var e={},t=c.calculateFilteredKSlashNCombination(n,this.stake);return e.subExpectedPrizes=t.subExpectedPrizes,e.expectedPrize=t.totalExpectedPrize,e.multipleItems=t.multipleItems,e.totalStake=this.unitCount*this.stake,e}}(a)}))}},l.multipleBetslip=[],l.specialWithSimple=["PATENT","LUCKY_15","LUCKY_31","LUCKY_63"],l.isExistsCombinationBanItem=!1,l.isExistsCombinationCountBanItem=!1,l.bankerSelectedItemLength=0,l.ignoreKSlashNCombinations=["8/19","9/19","10/19","11/19","7/20","8/20","9/20","10/20","11/20","12/20","13/20"],l.generate=function(e,t){var t=t||{},n={},i=1,o=2147483647;for(l in t.singleCombination||(t.singleCombination=!1),t.specialCombination||(t.specialCombination=!0),this.multipleBetslip=[],this.isExistsCombinationBanItem=!1,this.isExistsCombinationCountBanItem=!1,this.bankerSelectedItemLength=0,e.items)e.items[l].multipleSelection&&(i<e.items[l].minCombiCount&&(i=e.items[l].minCombiCount),e.items[l].maxCombiCount<o&&(o=e.items[l].maxCombiCount),this.multipleBetslip.push(e.items[l]),0<e.items[l].combinationBanMessages.length&&(this.isExistsCombinationBanItem=!0),0<e.items[l].combinationCountBanMessages.length&&(this.isExistsCombinationCountBanItem=!0),e.items[l].bankerSelection&&this.bankerSelectedItemLength++);if(i>this.multipleBetslip.length)e.multiple={};else if(t.singleCombination&&(d.singleCombination(n,{data:e,multipleBetslip:this.multipleBetslip}),1===this.multipleBetslip.length))e.multiple=n;else if(this.multipleBetslip.length<=1)e.multiple={};else{if(!this.isExistsCombinationBanItem&&o>=this.multipleBetslip.length&&d.nCombination(n,{data:e,multipleBetslip:this.multipleBetslip}),0===this.bankerSelectedItemLength){if(2<=this.multipleBetslip.length&&(this.isExistsCombinationBanItem?d.filteredKSlashNCombination(n,{data:e,multipleBetslip:this.multipleBetslip,bankerSelectedItemLength:0,minCombiCount:i,maxCombiCount:o}):d.kSlashNCombination(n,{data:e,multipleBetslip:this.multipleBetslip,minCombiCount:i,maxCombiCount:o})),!this.isExistsCombinationBanItem&&!this.isExistsCombinationCountBanItem&&3<=this.multipleBetslip.length&&this.multipleBetslip.length<=8&&t.specialCombination)for(var a=CONSTS.BETSLIP.SPECIAL_COMBINATIONS[this.multipleBetslip.length],r=0,s=a.length;r<s;r++)d.specialCombination(n,{data:e,multipleBetslip:this.multipleBetslip,combinationName:a[r],specialWithSimple:this.specialWithSimple,isExistsCombinationBanItem:this.isExistsCombinationBanItem,isExistsCombinationCountBanItem:this.isExistsCombinationCountBanItem,minCombiCount:i,maxCombiCount:o})}else 0<this.bankerSelectedItemLength&&d.filteredKSlashNCombination(n,{data:e,multipleBetslip:this.multipleBetslip,bankerSelectedItemLength:this.bankerSelectedItemLength,minCombiCount:i,maxCombiCount:o});for(var l in e.multiple)n[l]&&e.multiple[l].trackedAddToCartStake&&(n[l].trackedAddToCartStake=e.multiple[l].trackedAddToCartStake);e.multiple=n}},l}e.$inject=["betslipRounding"],angular.module("tippmixBetslipServices").factory("betslipCombination",e)}(),function(){function e(s){var e={calculate:function(e,t,n,i){i=i||!1,t.totalStake=0,t.expectedPrize=0,this.calculateSingle(e,t,i),this.calculateMultiple(e,t,i),t.expectedPrize=s.rounding(t.expectedPrize,3),n&&(0===t.totalStake?t.totalOdds=0:t.totalOdds=t.expectedPrize/t.totalStake)},calculateSingle:function(i,e,o){var a=0,r=0;angular.forEach(i.single,function(e,t){var n=e.stake;n&&""!==n&&(n=parseInt(n),t=s.rounding(n*i.items[t].fixedOdds,3),e.expectedPrize=t,o&&!angular.isDefined(e.internalBOKey)||(a+=n,r+=t))}),e.totalStake+=a,e.expectedPrize+=r},calculateMultiple:function(e,t,i){var o=0,a=0;angular.forEach(e.multiple,function(e){var t,n=e.stake;n&&""!==n?"function"==typeof e.calculator&&(e.stake=parseInt(e.stake,10),(t=e.calculator()).expectedPrize=s.rounding(t.expectedPrize,2),e.totalStake=t.totalStake,e.subExpectedPrizes=t.subExpectedPrizes,e.expectedPrize=t.expectedPrize,e.multipleItems=t.multipleItems||null,i&&!angular.isDefined(e.internalBOKey)||(o+=t.totalStake,a+=t.expectedPrize)):""===n&&angular.isUndefined(e.externalBOKey)&&(e.totalStake=0,e.subExpectedPrizes=[],e.expectedPrize=0)}),t.totalStake+=o,t.expectedPrize+=a}};return e}e.$inject=["betslipRounding"],angular.module("tippmixBetslipServices").factory("betslipCalculator",e)}(),function(p){function e(t,r,o,e){var n,i,a={},d=null;function c(e,t){var n=[];if(!angular.isArray(e)||!angular.isArray(t))return n;for(var i=0,o=e.length;i<o;i++){var a=e[i];-1!==t.indexOf(a)&&-1===n.indexOf(a)&&n.push(a)}return n}function s(e,t,n){if(!e||!t)return e===t;if(e.length===t.length){for(var i=0,o=e.length;i<o;i++){for(var a=0,r=t.length;a<r&&e[i][n]!==t[a][n];a++);if(i===o||a===r)return;if(!e[i].cCGroupIds||!t[a].cCGroupIds)return e[i].cCGroupIds===t[a].cCGroupIds;if(e[i].cCGroupIds.length!==t[a].cCGroupIds.length)return;for(var s=0,l=e[i].cCGroupIds.length;s<l;s++)if(-1===t[a].cCGroupIds.indexOf(e[i].cCGroupIds[s]))return}return 1}}function m(e,t){var n,i=0;if(angular.isArray(e.competitionClosedCombinations))for(n=e.competitionClosedCombinations.length,i=0;i<n;i++){var o=e.competitionClosedCombinations[i];if(o.competitionId===t.competitionId&&0<c(o.cCGroupIds,t.marketTypeCCGroups).length)return!0}if(angular.isArray(e.eventClosedCombinations))for(n=e.eventClosedCombinations.length,i=0;i<n;i++){var a=e.eventClosedCombinations[i];if(a.eventId===t.eventId&&0<c(a.cCGroupIds,t.marketTypeCCGroups).length)return!0}return!(!angular.isArray(e.marketClosedCombinations)||-1===e.marketClosedCombinations.indexOf(t.marketId))}function l(s,l,e,d){var u={messages:[],combinationBanKeys:[]};return l.multipleSelection&&angular.forEach(e,function(e,t){var n,i,o,a,r;s!==t&&e.multipleSelection&&(n=null,n=d.vSport?(o=e,a=(i=l).competitionId===o.competitionId,r=i.marketRoundId===o.marketRoundId,!!(a&&r&&(i.isOutright&&o.isOutright||i.isOutright&&!o.isOutright||!i.isOutright&&o.isOutright))||(a=i.eventId===o.eventId,r=0<c(i.marketTypeCCGroups,o.marketTypeCCGroups).length,!i.isOutright&&!o.isOutright&&a&&r)):function(e,t){if(angular.isArray(e.marketTypeCCGroups)&&angular.isArray(t.marketTypeCCGroups)&&!(0<c(e.marketTypeCCGroups,t.marketTypeCCGroups).length))return!1;var n=e.eventId===t.eventId,i=e.competitionId===t.competitionId,e=0<c(e.eventParticipants,t.eventParticipants).length;return!!(n||i&&e)}(l,e),i=(i=m(l,e))&&m(e,l),(n||i)&&(e.isCustomBetable&&0<e.customBetItems.length?u.messages.push("Fogadáskészítő ("+e.eventName+")"):u.messages.push(e.outcomeName+" ("+e.eventName+" / "+e.marketName+")"),u.combinationBanKeys.push(t)))}),u}return e.has("GTMService")&&(d=e.get("GTMService")),a.checkCombinationBan=function(n,i){i=i||{},angular.forEach(n,function(e,t){t=l(t,e,n,i);e.combinationBanMessages=t.messages,e.combinationBanKeys=t.combinationBanKeys})},a.checkCombinationCountBan=function(e){var t,n=0;angular.forEach(e,function(e){e.multipleSelection&&n++}),angular.forEach(e,function(e){e.combinationCountBanMessages=[],t=[],e.multipleSelection&&(1<e.minCombiCount&&(e.isCustomBetable&&0<e.customBetItems.length?t.push({name:"Fogadáskészítő ("+e.eventName+")",isMinCombiCountBan:!0}):t.push({name:e.outcomeName+" ("+e.eventName+" / "+e.marketName+")",isMinCombiCountBan:!0})),e.maxCombiCount<n&&(e.isCustomBetable&&0<e.customBetItems.length?t.push({name:"Fogadáskészítő ("+e.eventName+")",isMaxCombiCountBan:!0}):t.push({name:e.outcomeName+" ("+e.eventName+" / "+e.marketName+")",isMaxCombiCountBan:!0}))),e.combinationCountBanMessages=t})},a.checkBets=function(o){var a;0<o.length()&&(a=[],angular.forEach(o.data.items,function(e){a.push({eventId:e.eventId,marketId:e.marketId,outcomeNo:e.outcomeNo,fixedOdds:e.fixedOdds,eventClosedCombination:e.eventClosedCombinations,competitionClosedCombination:e.competitionClosedCombinations,marketClosedCombination:e.marketClosedCombinations})}),r.async("betslip-check",{details:a}).then(function(e){if(e.data!==p)for(var t=0,n=e.data.length;t<n;t++){var i=e.data[t].eventId+"-"+e.data[t].marketId+"-"+e.data[t].outcomeNo;void 0===e.data[t].eventClosedCombination||s(e.data[t].eventClosedCombination,a[t].eventClosedCombination,"eventId")||(o.data.items[i].combinationBanFromBetslipCheck=!0,o.data.items[i].eventClosedCombinations=e.data[t].eventClosedCombination),void 0===e.data[t].competitionClosedCombination||s(e.data[t].competitionClosedCombination,a[t].competitionClosedCombination,"competitionId")||(o.data.items[i].combinationBanFromBetslipCheck=!0,o.data.items[i].competitionClosedCombinations=e.data[t].competitionClosedCombination),_typeof(e.data[t].marketClosedCombination)&&!function(e,t){if(!e||!t)return e===t;if(e.length===t.length){for(var n=0,i=e.length;n<i;n++)if(-1===t.indexOf(e[n]))return;return 1}}(e.data[t].marketClosedCombination,a[t].marketClosedCombination)&&(o.data.items[i].combinationBanFromBetslipCheck=!0,o.data.items[i].marketClosedCombinations=e.data[t].marketClosedCombination),0===e.data[t].statusCode?2===o.data.items[i].statusCode&&(o.data.items[i].statusCode=0):(o.data.items[i].statusCode=e.data[t].statusCode,1===e.data[t].statusCode&&(o.data.items[i].fixedOdds=e.data[t].fixedOdds))}}))},a.flattenItems=function(e){var t,n={};for(t in e)n[t]=e[t],0<e[t].customBetItems.length&&e[t].customBetItems.forEach(function(e){e.isCustomBetItem=!0,n[e.id]=e});return n},a.checkTippmixBets=function(c){if(0<c.getPrematchItemsLength()+c.getLiveItemsLength()){var e=[],t=this.flattenItems(c.data.prematch.items);for(i in t)t[i].eventId&&t[i].marketId&&t[i].outcomeNo&&t[i].fixedOdds&&e.push({eventId:t[i].eventId,marketId:t[i].marketId,outcomeNo:t[i].outcomeNo,fixedOdds:t[i].fixedOdds,eventClosedCombination:t[i].eventClosedCombinations,competitionClosedCombination:t[i].competitionClosedCombinations,marketClosedCombination:t[i].marketClosedCombinations,isCustomBet:t[i].isCustomBetItem||!1});var n=this.flattenItems(c.data.live.items);for(i in n)n[i].eventId&&n[i].marketId&&n[i].outcomeNo&&n[i].fixedOdds&&e.push({eventId:n[i].eventId,marketId:n[i].marketId,outcomeNo:n[i].outcomeNo,fixedOdds:n[i].fixedOdds,eventClosedCombination:n[i].eventClosedCombinations,competitionClosedCombination:n[i].competitionClosedCombinations,marketClosedCombination:n[i].marketClosedCombinations,isCustomBet:n[i].isCustomBetItem||!1});r.async("tippmix/betslip-check",{details:e}).then(function(e){if(e.data!==p)for(var t=0,n=e.data.length;t<n;t++)if(0!==e.data[t].statusCode){var i=e.data[t].eventId+"-"+e.data[t].marketId+"-"+e.data[t].outcomeNo,o=null,a=null,r=e.data[t].eventId;if(c.data.prematch.items[i]?o="prematch":c.data.live.items[i]&&(o="live"),null!==o&&(c.data[o].items[i].statusCode=e.data[t].statusCode,1===e.data[t].statusCode&&(c.data[o].items[i].fixedOdds=e.data[t].fixedOdds)),c.data.prematch.items[r]?a="prematch":c.data.live.items[r]&&(a="live"),null!==a){for(var s=[],l=0;l<c.data[a].items[r].customBetItems.length;l++){var d=c.data[a].items[r].customBetItems[l].id.split("-"),u=e.data.findIndex(function(e){return e.eventId===parseInt(d[0])&&e.marketId===parseInt(d[1])&&e.outcomeNo===parseInt(d[2])});s.push(e.data[u].statusCode)}o=s.filter(function(e,t,n){return n.indexOf(e)===t}),i=Math.max.apply(Math,_toConsumableArray(o));1===i&&(o.splice(o.indexOf(i),1),i=0<o.length?Math.max.apply(Math,_toConsumableArray(o)):null),c.data[a].items[r].statusCode=i}}})}if(0<c.getVSportItemsLength()){var i,e=[];for(i in c.data.vSport.items)e.push({eventId:c.data.vSport.items[i].eventId,marketId:c.data.vSport.items[i].marketId,outcomeNo:c.data.vSport.items[i].outcomeNo,fixedOdds:c.data.vSport.items[i].fixedOdds,eventClosedCombination:c.data.vSport.items[i].eventClosedCombinations,competitionClosedCombination:c.data.vSport.items[i].competitionClosedCombinations,marketClosedCombination:c.data.vSport.items[i].marketClosedCombinations});r.async(o.vSportApiUrl+"tippmix/betslip-check",{details:e},!0).then(function(e){if(e.data!==p)for(var t,n,i=0,o=e.data.length;i<o;i++)0!==e.data[i].statusCode&&(t=e.data[i].eventId+"-"+e.data[i].marketId+"-"+e.data[i].outcomeNo,(n=null)!==(n=c.data.vSport.items[t]?"vSport":n)&&(c.data[n].items[t].statusCode=e.data[i].statusCode,1===e.data[i].statusCode&&(c.data[n].items[t].fixedOdds=e.data[i].fixedOdds)))})}},a.merge=function(i,e){var n=!1;angular.forEach(e.items,function(e,t){t=i.items[t];angular.isDefined(e.oldFixedOdds)?(t.fixedOdds=e.fixedOdds,t.oldFixedOdds=e.oldFixedOdds,e.multipleSelection&&(n=!0)):delete t.oldFixedOdds,angular.isDefined(e.errorIcon)&&(t.errorIcon=e.errorIcon)}),angular.forEach(e.single,function(e,t){var n=i.single[t];angular.isDefined(e.drop)&&(n.drop=e.drop,n.drop&&(angular.isDefined(i.items[t].oldFixedOdds)&&(n.oldExpectedPrize=n.expectedPrize),angular.isDefined(e.oldStake)&&(n.stake=e.stake,n.oldStake=e.oldStake,n.oldExpectedPrize=n.expectedPrize,n.oldTotalStake=n.totalStake),angular.isDefined(i.items[t].oldFixedOdds)||angular.isDefined(e.oldStake)||(delete n.oldExpectedPrize,delete n.oldTotalStake))),angular.isDefined(e.externalBOKey)&&(n.externalBOKey=e.externalBOKey),angular.isDefined(e.internalBOKey)&&(n.internalBOKey=e.internalBOKey),angular.isDefined(e.submissionDate)&&(n.submissionDate=e.submissionDate),angular.isDefined(e.needToBeConfirmed)&&(angular.isDefined(e.oldStake)&&(n.stake=e.stake,n.oldStake=e.oldStake),n.needToBeConfirmed=e.needToBeConfirmed,n.oldExpectedPrize=n.expectedPrize),angular.isDefined(e.errorMessage)&&(n.errorMessage=e.errorMessage),angular.isDefined(e.errorType)&&(n.errorType=e.errorType)}),angular.forEach(e.multiple,function(e,t){t=i.multiple[t];t.stake=e.stake,angular.isDefined(e.drop)&&(t.drop=e.drop,t.drop&&(n&&(t.oldExpectedPrize=t.expectedPrize),angular.isDefined(e.oldStake)&&(t.stake=e.stake,t.oldStake=e.oldStake,t.oldExpectedPrize=t.expectedPrize,t.oldTotalStake=t.totalStake),n||angular.isDefined(e.oldStake)||(delete t.oldExpectedPrize,delete t.oldTotalStake))),angular.isDefined(e.externalBOKey)&&(t.externalBOKey=e.externalBOKey),angular.isDefined(e.internalBOKey)&&(t.internalBOKey=e.internalBOKey),angular.isDefined(e.submissionDate)&&(t.submissionDate=e.submissionDate),angular.isDefined(e.needToBeConfirmed)&&(angular.isDefined(e.oldStake)&&(t.stake=e.stake,t.oldStake=e.oldStake),t.needToBeConfirmed=e.needToBeConfirmed,t.oldExpectedPrize=t.expectedPrize,t.oldTotalStake=t.totalStake),angular.isDefined(e.errorMessage)&&(t.errorMessage=e.errorMessage),angular.isDefined(e.errorType)&&(t.errorType=e.errorType)})},a.updateByResponse=function(e){var n=angular.copy(e),i=!0,t=!0,o=!1,a=!1,r=!1,s=!1,l=!1;return angular.forEach(n.items,function(e,t){e.oldFixedOdds&&e.multipleSelection&&(r=!0)}),angular.forEach(n.single,function(e,t){""!==e.stake&&(e.drop?(e.stake="",n.items[t].oldFixedOdds&&(a=!0),e.oldStake&&(s=!0)):i=!1),e.needToBeConfirmed&&(o=!0)}),angular.forEach(n.multiple,function(e){""!==e.stake&&(e.drop?(e.stake="",e.oldStake&&(l=!0)):t=!1),e.needToBeConfirmed&&(o=!0)}),{isClearBetslip:i&&t,isNeedToBeConfirmedItem:o,changedFixedOddsItem:a||r,changedStakeItem:s||l,data:n}},a.getErrorMessages=function(n){var i=[];return angular.forEach(n.single,function(e,t){""!==e.stake&&angular.isDefined(e.errorMessage)&&(t=n.items[t],i.push(t.eventName+" "+t.outcomeName+" ("+t.marketName+") - "+e.errorMessage))}),angular.forEach(n.multiple,function(e){""!==e.stake&&angular.isDefined(e.errorMessage)&&i.push(e.title+" - "+e.errorMessage)}),i},a.showBackdrop=function(t){t=t||"A fogadás visszaigazolása a megszokottnál több időt vehet igénybe.",n=setTimeout(function(){var e=$(".betslip-backdrop");(e=e.length?e:$('<div class="betslip-backdrop"><span></span><div class="betslip-backdrop-text">'+t+"</div></div>").appendTo(document.body)).removeClass("betslip-backdrop--show-text"),e.fadeIn(250),i=setTimeout(function(){e.addClass("betslip-backdrop--show-text")},1e4)},500)},a.hideBackdrop=function(){clearTimeout(n),clearTimeout(i),$(".betslip-backdrop").fadeOut(250)},a.setRedirectUrl=function(e){sessionStorage.setItem(t.redirectSessionName,e)},a.getRedirectUrl=function(){var e=sessionStorage.getItem(t.redirectSessionName);return e=null===e?o.homePageUrl:e},a.sendTransactions=function(i,e,t){t=t||!1;var e=e||Date.now(),o=0,a=!1,n="tippmixpro.hu-"+("1"===CONSTS.SITE.IS_MOBILE?"mobile":"desktop"),r=!1,s=[],l=null;if(angular.forEach(i.single,function(e,t){var n;e.internalBOKey&&""!==e.internalBOKey&&!e.gtmTracked?(n=parseInt(e.stake,10),isNaN(n)||(d.trackTransactionFromSingle(i.items[t],e.stake,s),o+=n,a=!0,e.gtmTracked=!0,l=e.internalBOKey)):"STAK_EXCEED_ACCBAL"===e.errorType&&(r=!0)}),angular.forEach(i.multiple,function(e){var t;e.internalBOKey&&""!==e.internalBOKey&&!e.gtmTracked?(t=parseInt(e.totalStake,10),isNaN(t)||(s=d.trackTransactionFromMultiple(i.items,e,s),o+=t,a=!0,e.gtmTracked=!0,l=e.internalBOKey)):"STAK_EXCEED_ACCBAL"===e.errorType&&(r=!0)}),0<s.length&&(t=t?e+"-"+l:e,d.trackTransaction(t,n,o,s)),r&&d.trackEvent("Nincs elég fedezet","Nincs elég fedezet"),a&&"undefined"!=typeof PostAffTracker){t=PostAffTracker.createSale();t.setTotalCost(o),t.setOrderID(e);try{PostAffTracker.track()}catch(e){}}},a.getParticipantsIds=function(e){var t=[],n=0;if(angular.isUndefined(e)||null===e)return t;for(n=e.length;n--;)t.push(e[n].participantId);return t},a.getBetslipItem=function(e,t,n){return{eventId:e.eventId,eventName:e.eventName,eventDate:e.eventDate,eventVersion:e.eventVersion,marketId:t.marketId,marketName:t.marketName,marketVersion:t.marketVersion,outcomeNo:n.outcomeNo,outcomeName:n.outcomeName,fixedOdds:n.fixedOdds,multipleSelection:!0,bankerSelection:!1,competitionId:e.competitionId,eventClosedCombinations:e.eventClosedCombinations,marketClosedCombinations:t.marketClosedCombinations,competitionClosedCombinations:e.competitionClosedCombinations,marketTypeCCGroups:t.marketTypeCCGroups,eventParticipants:a.getParticipantsIds(e.eventParticipants),combinationBanKeys:[],combinationBanMessages:[],combinationCountBanMessages:[],combinationBanFromBetslipCheck:!1,statusCode:0,isLive:e.isLive,minCombiCount:t.minCombiCount,maxCombiCount:t.maxCombiCount,addToBetslip:Date.now(),competitionGroupName:e.competitionGroupName,competitionName:e.competitionName,sportName:e.sportName}},a}e.$inject=["betslipSettings","httpService","settings","$injector"],angular.module("tippmixBetslipServices").factory("betslipService",e)}(void 0),function(){function e(i){var e={roundingByMethodAndValue:function(e){var t=i.prizeAmountRoundingValue/100,n=e/t;switch(i.prizeAmountRoundingMethod){case 1:n=Math.round(n);break;case 2:n=Math.floor(n);break;case 3:n=Math.ceil(n)}return n=10*n*(10*t)/100},rounding:function(e,t){return 0===e?e:i.prizeAmountRoundingLevel===t?this.roundingByMethodAndValue(e):i.prizeAmountRoundingLevel>t?parseFloat(parseFloat(e).toFixed(i.totalOddsAccuracy)):e}};return e}e.$inject=["betslipSettings"],angular.module("tippmixBetslipServices").factory("betslipRounding",e)}(),function(r){function e(i,s){var o={DEFAULT:{layout:"double",scoreboard:"extended",detailedScoreboard:"enable",momentum:"compact",activeSwitcher:"scoreDetails",collapseTo:"disable",tabsPosition:"top",pitchLogo:location.origin+"/betradar-pitch-logo.png",goalBannerImage:location.origin+"/betradar-sideline-logo.png"}},a=".lmt-container";function l(e,t,n){n=n||function(){};t=r.copy(o[t]);t.matchId=e,t.onTrack=n,SIR("addWidget",a,"match.lmtPlus",t)}function d(e,t,n){i(function(){e.fallback=!1,("license_error"===t||"data_change"===t&&n.error||"fixture-load-error"===t)&&(e.fallback=!0,e.showPartScore=-1!==s.rowDisplaySportIds.indexOf(e.event.sportId))})}return{restrict:"AE",scope:{betradarId:"=",event:"="},link:function(a,e,r){a.$watch("betradarId",function(){var n,e,t,i,o;e=r,(n=a).betradarId&&(e.footnote&&(n.footnote=e.footnote),e.configId||(e.configId="DEFAULT"),t=(t=s.betradarLiveUrl).replace("{siteId}",e.siteId),i="sportradar",null===document.getElementById(i)?((o=document.createElement("script")).id=i,o.src=t,o.async=1,o.n="SIR",o.onload=function(){SIR("changeLanguage","hu"),SIR("setClientTheme",!1),l(n.betradarId,e.configId,function(e,t){d(n,e,t)})},document.body.appendChild(o)):l(n.betradarId,e.configId,function(e,t){d(n,e,t)}))})},template:'\t\t\t\t<div ng-show="betradarId && (!fallback || (fallback && event.currentScore))">\t\t\t\t\t<div ng-show="!fallback" class="lmt-container"></div>\t\t\t\t\t<div ng-show="fallback">\t\t\t\t\t\t<div ng-show="!showPartScore" class="betradar-fallback betradar-fallback--current-score">\t\t\t\t\t\t\t<div class="betradar-fallback-play-time" ng-show="event.liveScoreStatusDesc" ng-bind="event.liveScoreStatusDesc + (event.matchPlayTime ? \' | \' + event.matchPlayTime + \'. perc\' : \'\')"></div>\t\t\t\t\t\t\t<div class="betradar-fallback-left">\t\t\t\t\t\t\t\t<div class="betradar-fallback-team-name" ng-bind="event.eventParticipants[0].participantName"></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="betradar-fallback-center">\t\t\t\t\t\t\t\t<div class="betradar-fallback-current-score" ng-bind="event.currentScore"></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="betradar-fallback-right">\t\t\t\t\t\t\t\t<div class="betradar-fallback-team-name" ng-bind="event.eventParticipants[1].participantName">Korban, Sergey</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div ng-show="showPartScore" class="betradar-fallback betradar-fallback--part-score">\t\t\t\t\t\t\t<div class="betradar-fallback-play-time" ng-show="event.liveScoreStatusDesc" ng-bind="event.liveScoreStatusDesc + (event.matchPlayTime ? \' | \' + event.matchPlayTime + \'. perc\' : \'\')"></div>\t\t\t\t\t\t\t<div class="betradar-fallback-left" ng-style="{\'max-width\': \'calc(100% - \' + (event.liveScorePartList1.length * 20 + 10) + \'px)\'}">\t\t\t\t\t\t\t\t<div class="betradar-fallback-team-name" ng-bind="event.eventParticipants[0].participantName"></div>\t\t\t\t\t\t\t\t<div class="betradar-fallback-team-name" ng-bind="event.eventParticipants[1].participantName"></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="betradar-fallback-right">\t\t\t\t\t\t\t\t<div class="betradar-fallback-part-results">\t\t\t\t\t\t\t\t\t<div class="betradar-fallback-part-result" ng-repeat="partItem in event.liveScorePartList1" ng-bind="partItem.partScore"></div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t<div class="betradar-fallback-part-results">\t\t\t\t\t\t\t\t\t<div class="betradar-fallback-part-result" ng-repeat="partItem in event.liveScorePartList2" ng-bind="partItem.partScore"></div>\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t</div>\t\t\t\t\t</div>\t\t\t\t\t<p ng-bind="footnote"></p>\t\t\t\t</div>\t\t\t'}}e.$inject=["$timeout","settings"],r.module("tippmixBetradar",[]).directive("betradar",e).value("settings",{betradarLiveUrl:"",rowDisplaySportIds:[]})}(angular),angular.module("SCPWidgets",[]),angular.module("SCPServices",[]),angular.module("SCPDirectives",[]),angular.module("SCP",["ngDialog","ngMessages","SCPWidgets","SCPServices","SCPDirectives"]).value("SCPConfigs",{api:{baseUrl:window.SCPApiURL,timeout:3e4,url:{registration:"register",login:"login",logout:"logout",validateCode:"validatecode",validateEmail:"validateemail",codes:"codes",draws:"draws",userInfo:"userinfo",uploadCode:"uploadcode",updateProfile:"update",startPasswordRecovery:"startpasswordrecovery",finishPasswordRecovery:"finishpasswordrecovery",deleteProfile:"deleteprofile",subscriptions:"subscriptions",subscribe:"subscribe",updateSubscription:"updatesubscription",csrf:"csrf",journal:"journal",resendVerificationEmail:"resendverificationemail"}},modals:{registration:"SCPRegistrationModal",passwordRecovery:"SCPPasswordRecoveryModal",finishPasswordRecovery:"SCPFinishPasswordRecoveryModal",updateProfile:"SCPUpdateProfileModal",updatePassword:"SCPUpdatePasswordModal",deleteProfile:"SCPDeleteProfileModal",uploadCode:"SCPUploadCodeModal",subscribe:"SCPSubscribeModal"},csrf:CONSTS.CSRF,reCaptchaEnabled:window.SCPRecaptchaEnabled,reCaptcha:CONSTS.RECAPTCHA}).value("SCPParams",{userData:window.SCPUserData,customerData:window.SCPCustomerData,promotionId:window.SCPPromotionId,promotion:window.SCPPromotion,promotionActive:window.SCPPromotionActive,termsURL:window.SCPTermsURL,action:window.SCPAction,message:window.SCPMessage,secret:window.SCPSecret}).run(["$rootScope",function(e){}]),function(){function e(i,r,o,s,a,l,d){var e={};function u(e,t,n){t=t||{},t=angular.extend({},t,l.getCSRF()),t=$.param(t),i({method:"POST",url:s.api.baseUrl+"/"+s.api.url[e],data:t,timeout:s.api.timeout,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0}).then(function(e){e.data.success?n.resolve(e.data):-1!==["USER_DELETED","NOT_LOGGED_IN"].indexOf(e.data.error)||"string"==typeof e.data?o.location.reload():n.reject(a.normalizeErrorFromResponse(e.data))})}return e.post=function(e,t,n){var i=r.defer(),o=r.defer(),a=o.promise;return s.reCaptchaEnabled&&n?(a=d.getToken()).then(function(e){(t=t||{}).captcha=e}):o.resolve(),a.then(function(){l.hasCSRF()?u(e,t,i):l.initCSRF(function(){u(e,t,i)})}),i.promise},e}e.$inject=["$http","$q","$window","SCPConfigs","SCPUtilsService","SCPCsrf","SCPReCaptcha"],angular.module("SCPServices").factory("SCPHttpService",e)}(),function(){function e(n,i){var e={open:function(e,t){return void 0===(t=t||{}).showClose&&(t.showClose=!0),void 0===t.closeByEscape&&(t.closeByEscape=!0),void 0===t.closeByDocument&&(t.closeByDocument=!1),void 0===t.className&&(t.className="scp-modal-wrapper"),void 0===t.data&&(t.data=null),n.open({template:i.modals[e],showClose:t.showClose,closeByEscape:t.closeByEscape,closeByDocument:t.closeByDocument,className:t.className,data:t.data})}};return e}e.$inject=["ngDialog","SCPConfigs"],angular.module("SCPServices").factory("SCPModalService",e)}(),angular.module("SCPServices").factory("SCPUtilsService",function(){var i={normalizeErrorFromResponse:function(e){var t=[];if("validation"===e.error)for(var n in e.validation_errors)t.push({errorKey:n,errorMessage:e.validation_errors[n][0]});else t.push({errorKey:i.normalizeErrorKey(e.error),errorMessage:e.error,codeErrors:e.codeValidationErrors});return t},normalizeErrorKey:function(e){return e.split(" ").join("_").toUpperCase()},getBirthYears:function(){for(var e=[],t=(new Date).getFullYear()-18;1899<t;t--)e.push(t);return e},getBirthMonths:function(){for(var e=[],t=1;t<13;t++){var n=t<10?"0"+t:t;e.push(n.toString())}return e},getBirthDate:function(){for(var e=[],t=1;t<32;t++){var n=t<10?"0"+t:t;e.push(n.toString())}return e},check18YearsOld:function(e,t,n){var i=new Date,o=i.getFullYear()-18,a=i.getMonth()+1,i=i.getDate();return e=parseInt(e,10),t=parseInt(t,10),n=parseInt(n,10),!(e<o)&&(!(t<a)&&!(t===a&&n<=i))},checkPassword:function(e){var t=!1,n=("string"==typeof e&&e.length<8&&(t=!0),0);return/[~\!@#\$%\^&\*_\-\+\=`\|\(\)\{\}\[\]\:;"'\<\>,\.\?\/]+/.test(e)&&n++,/[A-ZÁÉIÍÓÖŐÚÜŰ]+/.test(e)&&n++,/[a-záéiíóöőúüű]+/.test(e)&&n++,/[0-9]+/.test(e)&&n++,t=n<3?!0:t}};return i}),function(){function e(e,i){var t={},o=i.csrf;return t.initCSRF=function(t,n){t=t||function(){},n=n||function(){},e({method:"GET",url:i.api.baseUrl+"/csrf",timeout:i.api.timeout,withCredentials:!0}).then(function(e){e.data["csrf-token-name"]&&e.data["csrf-token"]?((o={})[e.data["csrf-token-name"]]=e.data["csrf-token"],t()):n()})},t.getCSRF=function(){return o},t.hasCSRF=function(){return null!==o},t}e.$inject=["$http","SCPConfigs"],angular.module("SCPServices").factory("SCPCsrf",e)}(),function(){function e(e,n,i){var t={getToken:function(e){var t=n.defer();return grecaptcha.ready(function(){grecaptcha.execute(i.reCaptcha,{action:e||"submit"}).then(function(e){t.resolve(e)})}),t.promise}};return t}e.$inject=["$http","$q","SCPConfigs"],angular.module("SCPServices").factory("SCPReCaptcha",e)}(),function(){function e(d){return{restrict:"A",require:"?ngModel",link:function(o,e,t,n){var i,a,r,s;function l(){var e=i(o);return e=angular.isObject(e)&&e.hasOwnProperty("$viewValue")?e.$viewValue:e}n&&t.scpPasswordMatch&&(i=d(t.scpPasswordMatch),a=d(t.matchCaseless),r=d(t.notMatch),s=d(t.matchIgnoreEmpty),o.$watch(l,function(){n.$$parseAndValidate()}),n.$validators.match=function(e,t){var e=e||t,n=l(),i=r(o);return!(!s(o)||t)||(t=a(o)?angular.lowercase(e)===angular.lowercase(n):e===n,!!(t^=i))})}}}e.$inject=["$parse"],angular.module("SCPDirectives").directive("scpPasswordMatch",e)}(),angular.module("SCPDirectives").directive("scpTooltip",function(){return{restrict:"A",link:function(e,t,n){var i={items:"[scp-tooltip]",content:function(){return angular.element(t).find("[scp-tooltip-content]").html()},track:!1,show:{delay:0,duration:0},hide:{delay:0,duration:0},tooltipClass:"scp-tooltip nls_protected",position:{my:"center top+5",at:"center bottom+5",using:function(e,t){angular.element(this).css(e),angular.element(this).addClass(t.vertical).addClass(t.horizontal)}}};angular.element(t).tooltip(i)}}}),function(){function e(e){var n="loading";return{restrict:"A",link:function(e,t){e.formButton.disabledSpinner=!1,e.formButton.disabledButton=!1,e.formButton.enableButton=function(){e.formButton.disabledButton=!1,t.removeAttr("disabled")},e.formButton.disableButton=function(){e.formButton.disabledButton=!0,t.attr("disabled","disabled")},e.formButton.enableSpinner=function(){e.formButton.disableButton(),e.formButton.disabledSpinner=!0,t.addClass(n)},e.formButton.disableSpinner=function(){e.formButton.enableButton(),e.formButton.disabledSpinner=!1,t.removeClass(n)}},scope:{formButton:"=scpFormButton"}}}e.$inject=["$timeout"],angular.module("SCPDirectives").directive("scpFormButton",e)}(),angular.module("SCPDirectives").directive("scpNumbersOnly",function(){return{restrict:"A",require:"ngModel",link:function(e,t,n,i){i.$parsers.push(function(e){var t=e.replace(/[^0-9]/g,"");return t!==e&&(i.$setViewValue(t),i.$render()),n.numbersLimit&&t.toString().length>n.numbersLimit&&(t=t.substring(0,n.numbersLimit),i.$setViewValue(t),i.$render()),t})}}}),function(){function e(n,i,e,o,a,r,t,s){var l=this,d=e.has("GTMService")?e.get("GTMService"):{trackEvent:angular.noop};l.submitted=!1,l.email=null,l.password=null,l.errors=null,l.errorsResend=null,l.errorsTypes={},l.passwordVisibility=!1,l.emailActivationEmail="",l.emailActivationResent=!1,i.formButton={},l.init=function(e){"recovery"===s.action&&""===s.message&&t.open("finishPasswordRecovery"),e&&e.errors&&(l.errorsTypes=e.errors)},l.submitForm=function(e,t){e.preventDefault(),l.submitted=!0,l.errors=null,l.emailActivationResent=!1,t?(i.formButton.enableSpinner(),l.emailActivationEmail=l.email,r.post("login",{email:l.email,password:l.password},!0).then(function(){n.location.href=n.location.origin+n.location.pathname,i.formButton.disableSpinner(),d.trackEvent("Second Chance","Belépés","Sikeres"),l.errorsResend=null},function(e){l.errors=e,i.formButton.disableSpinner(),l.submitted=!1;e=e.map(function(e){return l.errorsTypes[e.errorKey]||e.errorMessage});d.trackEvent("Second Chance","Belépés","Sikertelen - "+e.join(" | "))})):o(function(){var e=a.find(".scp-form__error-message").toArray().map(function(e){return angular.element(e).text().trim()});d.trackEvent("Second Chance","Belépés","Sikertelen - "+_.uniq(e).join(" | "))})},l.openRegistration=function(e){e.preventDefault(),t.open("registration")},l.openPasswordRecovery=function(e){e.preventDefault(),t.open("passwordRecovery")},l.resendActivation=function(e){e.preventDefault();e={promoPage:location.pathname};l.emailActivationEmail?e.email=l.emailActivationEmail:e.secret=s.secret,r.post("resendVerificationEmail",e,!0).then(function(){l.errors=null,l.errorsResend=null,l.emailActivationResent=!0},function(e){l.errorsResend=e})}}e.$inject=["$window","$scope","$injector","$timeout","$element","SCPHttpService","SCPModalService","SCPParams"],angular.module("SCPWidgets").controller("SCPLoginWidget",e)}(),function(){function e(n,t,i){var o=this;o.state=null,o.submitted=null,o.hideModalClose=!1,n.formButton={},o.init=function(){},o.submitForm=function(e,t){e.preventDefault(),o.submitted=!0,o.errors=null,t&&(n.formButton.enableSpinner(),i.post("deleteProfile",{password:o.password}).then(function(){o.state="success",o.hideModalClose=!0,n.formButton.disableSpinner()},function(e){o.errors=e,n.formButton.disableSpinner(),o.submitted=!1}))},o.cancel=function(e){e.preventDefault(),n.$parent.closeThisDialog()},o.closeAndRefresh=function(e){e.preventDefault(),t.location.href=t.location.origin+t.location.pathname}}e.$inject=["$scope","$window","SCPHttpService"],angular.module("SCPWidgets").controller("SCPDeleteProfileWidget",e)}(),function(){function e(n,e,i,o,a){var r=this,s=e.has("GTMService")?e.get("GTMService"):{trackEvent:angular.noop};r.submitted=!1,r.email=null,r.state=null,r.errorsTypes={},n.formButton={},r.init=function(e){e&&e.errors&&(r.errorsTypes=e.errors)},r.submitForm=function(e,t){e.preventDefault(),r.submitted=!0,r.errors=null,t?(n.formButton.enableSpinner(),a.post("startPasswordRecovery",{email:r.email,promoPage:location.pathname},!0).then(function(){r.state="success",n.formButton.disableSpinner(),s.trackEvent("Second Chance","Elfelejtett jelszó","Sikeres")},function(e){r.errors=e,n.formButton.disableSpinner(),r.submitted=!1;e=e.map(function(e){return r.errorsTypes[e.errorKey]||e.errorMessage});s.trackEvent("Second Chance","Elfelejtett jelszó","Sikertelen - "+e.join(" | "))})):i(function(){var e=o.find(".scp-form__error-message").toArray().map(function(e){return angular.element(e).text().trim()});s.trackEvent("Second Chance","Elfelejtett jelszó","Sikertelen - "+_.uniq(e).join(" | "))})},r.closeThisDialog=function(e){e.preventDefault(),n.$parent.closeThisDialog()}}e.$inject=["$scope","$injector","$timeout","$element","SCPHttpService"],angular.module("SCPWidgets").controller("SCPPasswordRecoveryWidget",e)}(),function(){function e(n,i,o,a,e){var r=this;r.submitted=!1,r.newPassword=null,r.rePassword=null,r.state=null,r.errors=null,r.invalidPassword=!1,r.showPasswordStrengthMeter=!1,n.formButton={},r.init=function(){},r.submitForm=function(e,t){e.preventDefault(),r.submitted=!0,r.errors=null,t&&!r.invalidPassword&&(n.formButton.enableSpinner(),o.post("finishPasswordRecovery",{password:r.newPassword,token:a.secret}).then(function(){r.state="success",n.formButton.disableSpinner(),i.$on("ngDialog.closing",function(){location.href=location.pathname})},function(e){r.errors=e,n.formButton.disableSpinner(),r.submitted=!1}))},r.checkPassword=function(){r.invalidPassword=e.checkPassword(r.newPassword),r.newPassword&&0<r.newPassword.length?r.showPasswordStrengthMeter=!0:r.showPasswordStrengthMeter=!1},r.closeThisDialog=function(e){e.preventDefault(),n.$parent.closeThisDialog()},r.focusPasswordInput=function(){r.newPassword&&0<r.newPassword.length&&(r.showPasswordStrengthMeter=!0)},r.blurPasswordInput=function(){r.showPasswordStrengthMeter=!1}}e.$inject=["$scope","$rootScope","SCPHttpService","SCPParams","SCPUtilsService"],angular.module("SCPWidgets").controller("SCPFinishPasswordRecoveryWidget",e)}(),function(){function e(n,e,t,i,o,a,r){var s=this,l=t.has("GTMService")?t.get("GTMService"):{trackEvent:angular.noop};s.state=null,s.submitted=null,s.errorsTypes={},s.email=null,s.lastName=null,s.firstName=null,s.month=null,s.day=null,s.password=null,s.repassword=null,s.phone1=null,s.phone2=null,s.dmSubscription=0,s.dataProcessingAgreement=0,s.termsAndConditions=0,s.ageRestriction=0,s.invalidPassword=!1,s.showPasswordStrengthMeter=!1,n.formButton={},s.init=function(e){e&&e.errors&&(s.errorsTypes=e.errors),s.email=o.customerData.email||null,s.lastName=o.customerData.lastName||null,s.firstName=o.customerData.firstName||null,s.phone1=o.customerData.area||null,s.phone2=o.customerData.phone||null},s.submitForm=function(e,t){e.preventDefault(),s.submitted=!0,s.errors=null,t&&!s.invalidPassword&&(n.formButton.enableSpinner(),e=s.phone1+s.phone2,i.post("registration",{Promo_RegisterRequest:{email:s.email,lastName:s.lastName,firstName:s.firstName,phoneNumber:e,dmSubscription:s.dmSubscription?1:0,dataProcessingAgreement:s.dataProcessingAgreement?1:0,termsAndConditions:s.termsAndConditions?1:0,ageRestriction:s.ageRestriction?1:0,promotionId:o.promotionId,aegisCustomerPersonId:o.customerData.customerPersonId||0,password:s.password},promoPage:location.pathname},!0).then(function(){s.state="success",n.formButton.disableSpinner(),l.trackEvent("Second Chance","Regisztráció","Sikeres")},function(e){s.errors=e,n.formButton.disableSpinner(),s.submitted=!1;e=e.map(function(e){return s.errorsTypes[e.errorKey]||e.errorMessage});l.trackEvent("Second Chance","Regisztráció","Sikertelen - "+e.join(" | "))}))},s.checkPassword=function(){s.invalidPassword=a.checkPassword(s.password),s.password&&0<s.password.length?s.showPasswordStrengthMeter=!0:s.showPasswordStrengthMeter=!1},s.closeThisDialog=function(e){e.preventDefault(),n.$parent.closeThisDialog()},s.openForgotPassword=function(e){e.preventDefault(),n.$parent.closeThisDialog(),r.open("passwordRecovery")},s.focusPasswordInput=function(){s.password&&0<s.password.length&&(s.showPasswordStrengthMeter=!0)},s.blurPasswordInput=function(){s.showPasswordStrengthMeter=!1}}e.$inject=["$scope","$timeout","$injector","SCPHttpService","SCPParams","SCPUtilsService","SCPModalService"],angular.module("SCPWidgets").controller("SCPRegistrationWidget",e)}(),function(){function e(n,i,e){var o=this;o.state=null,o.submitted=null,o.oldPassword=null,o.newPassword=null,o.rePassword=null,o.invalidOldPassword=!1,o.invalidPassword=!1,o.showPasswordStrengthMeter=!1,n.formButton={},o.init=function(){},o.submitForm=function(e,t){e.preventDefault(),o.submitted=!0,o.errors=null,!t||o.invalidOldPassword||o.invalidPassword||(n.formButton.enableSpinner(),i.post("updateProfile",{Promo_UpdateRequest:{oldPassword:o.oldPassword,password:o.newPassword},promoPage:location.pathname},!0).then(function(){o.state="success",n.formButton.disableSpinner()},function(e){o.errors=e,n.formButton.disableSpinner(),o.submitted=!1}))},o.checkOldPassword=function(){o.invalidOldPassword=!1,o.oldPassword===o.newPassword&&(o.invalidOldPassword=!0)},o.checkPassword=function(){o.invalidPassword=e.checkPassword(o.newPassword),o.newPassword&&0<o.newPassword.length?o.showPasswordStrengthMeter=!0:o.showPasswordStrengthMeter=!1},o.checkNewPassword=function(){o.checkOldPassword(),o.checkPassword()},o.focusPasswordInput=function(){o.newPassword&&0<o.newPassword.length&&(o.showPasswordStrengthMeter=!0)},o.blurPasswordInput=function(){o.showPasswordStrengthMeter=!1}}e.$inject=["$scope","SCPHttpService","SCPUtilsService"],angular.module("SCPWidgets").controller("SCPUpdatePasswordWidget",e)}(),function(){function e(n,i,t,o,a,e,s){var l=this;l.state=null,l.submitted=null,l.preload=!0,l.email=null,l.lastName=null,l.firstName=null,l.year=null,l.month=null,l.day=null,l.password=null,l.phone1=null,l.phone2=null,l.dmSubscription=null,l.disabledDmSubscription=!0,l.comparedProfileString=null,l.comparedSubscriptionString=null,l.winnerNotificationSubscription=0,l.notWinnerNotificationSubscription=0,l.years=e.getBirthYears(),l.months=e.getBirthMonths(),l.days=e.getBirthDate(),l.invalid18YearsOld=!1,l.changedProfileData=!1,l.changedSubscriptionData=!1,i.formButton={},l.init=function(){var e=[o.post("userInfo"),o.post("subscriptions")];t.all(e).then(function(e){for(var t,n=e[0].result,i=(l.email=n.email||null,l.lastName=n.lastName||null,l.firstName=n.firstName||null,n.birthDay&&(t=n.birthDay.split("T")[0].split("-"),l.year=t[0],l.month=t[1],l.day=t[2]),n.phoneNumber&&("1"===n.phoneNumber[0].toString()?(l.phone1=1,l.phone2=n.phoneNumber.substr(1)):(l.phone1=n.phoneNumber.substr(0,2),l.phone2=n.phoneNumber.substr(2))),l.disabledDmSubscription="boolean"!=typeof n.dmSubscription,l.dmSubscription=n.dmSubscription,e[1].result),o=0,a=i.length;o<a;o++){var r=i[o];r.promotionId===s.promotionId&&(r.winnerNotificationSubscription||1===r.winnerNotificationSubscription?l.winnerNotificationSubscription=!0:l.winnerNotificationSubscription=!1,r.notWinnerNotificationSubscription||1===r.notWinnerNotificationSubscription?l.notWinnerNotificationSubscription=!0:l.notWinnerNotificationSubscription=!1)}l.comparedProfileString=l.getComparedString("profile"),l.comparedSubscriptionString=l.getComparedString("subscription"),l.preload=!1})},l.getComparedString=function(e){return"profile"===e?l.email+"|"+l.lastName+"|"+l.firstName+"|"+l.year+"|"+l.month+"|"+l.day+"|"+l.phone1+"|"+l.phone2+"|"+(l.dmSubscription?"1":"0"):(l.winnerNotificationSubscription?"1":"0")+"|"+(l.notWinnerNotificationSubscription?"1":"0")},l.submitProfileForm=function(e,t){e.preventDefault(),l.submitted=!0,l.errors=null,t&&!l.invalid18YearsOld&&(i.formButton.enableSpinner(),e=l.year+"-"+l.month+"-"+l.day,t=l.phone1+l.phone2,t={email:l.email,lastName:l.lastName,firstName:l.firstName,phoneNumber:t,birthDay:e,oldPassword:l.password},l.disabledDmSubscription||(t.dmSubscription=l.dmSubscription?1:0),o.post("updateProfile",{Promo_UpdateRequest:t,promoPage:location.pathname,promotionId:s.promotionId}).then(function(){l.state="profile-success",n.$broadcast("SCPUpdatedProfile",{firstName:l.firstName,lastName:l.lastName}),i.formButton.disableSpinner()},function(e){l.errors=e,i.formButton.disableSpinner(),l.submitted=!1}))},l.submitSubscriptionForm=function(e,t){e.preventDefault(),l.submitted=!0,l.errors=null,t&&(i.formButton.enableSpinner(),o.post("updateSubscription",{Promo_UpdateSubscriptionRequest:{promotionId:s.promotionId,winnerNotificationSubscription:l.winnerNotificationSubscription?1:0,notWinnerNotificationSubscription:l.notWinnerNotificationSubscription?1:0}}).then(function(){l.state="subscription-success",i.formButton.disableSpinner()},function(e){l.errors=e,i.formButton.disableSpinner(),l.submitted=!1}))},l.openUpdateProfile=function(e){e.preventDefault(),i.$parent.closeThisDialog(),a.open("deleteProfile")},l.openUpdatePassword=function(e){e.preventDefault(),i.$parent.closeThisDialog(),a.open("updatePassword")},l.cancel=function(e){e.preventDefault(),i.$parent.closeThisDialog()},l.selectTab=function(e,t){e.preventDefault(),l.password=null,l.submitted=!1,l.errors=null,"profile"===t?l.state=null:"subscription"===t&&(l.state="subscription-form")},l.check18YearsOld=function(){l.invalid18YearsOld=e.check18YearsOld(l.year,l.month,l.day),l.changeProfileData()},l.changeProfileData=function(){null!==l.comparedProfileString&&l.comparedProfileString!==l.getComparedString("profile")?l.changedProfileData=!0:l.changedProfileData=!1},l.changeSubscriptionData=function(){null!==l.comparedSubscriptionString&&l.comparedSubscriptionString!==l.getComparedString("subscription")?l.changedSubscriptionData=!0:l.changedSubscriptionData=!1}}e.$inject=["$rootScope","$scope","$q","SCPHttpService","SCPModalService","SCPUtilsService","SCPParams"],angular.module("SCPWidgets").controller("SCPUpdateProfileWidget",e)}(),function(){function e(r,o,e,a,d){var u=this,s=e.has("GTMService")?e.get("GTMService"):{trackEvent:angular.noop};u.state=null,u.submitted=null,u.errorsTypes={},u.showToC=!0,u.termsURL=d.termsURL,u.codes=[{value:"",error:""}],u.isValid=!1,u.serverError=!1,r.formButton={},r.$on("SCPUpdatedCodes",function(e,t){0<t.codesLength&&(u.showToC=!1)}),u.init=function(e){e&&e.errors&&(u.errorsTypes=e.errors),0<r.$parent.ngDialogData.codesLength&&(u.showToC=!1)},u.submitForm=function(e){e.preventDefault(),u.submitted=!0,u.errors=null;for(var t=[],n=0,i=u.codes.length;n<i;n++)""!==u.codes[n].value&&t.push(u.codes[n].value);u.isValid&&(u.serverError=!1,r.formButton.enableSpinner(),a.post("uploadCode",{codes:t,promotionId:d.promotionId},!0).then(function(){u.state="success",o.$broadcast("SCPUploadedCode"),r.formButton.disableSpinner(),s.trackEvent("Second Chance","Szelvény feltöltése","Sikeres")},function(e){if(u.serverError=!0,e[0].codeErrors&&e[0].codeErrors.length)for(var t=0,n=e[0].codeErrors.length;t<n;t++)for(var i=0,o=u.codes.length;i<o;i++)u.codes[i].value===e[0].codeErrors[t].code&&(u.codes[i].error=e[0].codeErrors[t].error),u.codes[i].validated=!0;else u.errors=e;r.formButton.disableSpinner(),u.submitted=!1;var a=e.map(function(e){return u.errorsTypes[e.errorKey]||e.errorMessage});s.trackEvent("Second Chance","Szelvény feltöltése","Sikertelen - "+a.join(" | "))}))},u.resetUploadCode=function(e){e.preventDefault(),u.isValid=!1,u.state=null,u.submitted=null,u.codes=[{value:"",error:"",validated:!1}]},u.anotherCode=function(){u.codes.push({value:"",error:"",validated:!1})},u.leaveUploadInput=function(e){for(var t=angular.isArray(d.promotion.validCodeFormat)?d.promotion.validCodeFormat:[d.promotion.validCodeFormat],n=0,i=u.codes.length;n<i;n++)if(!u.codes[n].validated){if(!u.codes[n].error)for(var o=0,a=t.length;o<a;o++){var r=new RegExp("^"+t[o]+"$");if(u.codes[n].value){if(r.test(u.codes[n].value)){u.codes[n].error="";break}u.codes[n].error="CODE_INVALID"}}for(var s=0,l=n+1;s<l;s++)if(u.codes[l]&&u.codes[l].value&&!u.codes[s].error&&u.codes[s].value===u.codes[l].value){u.codes[l].error="CODE_DUPLICATE";break}}},u.changeUploadInput=function(e){for(var t=0,n=u.codes.length;t<n;t++)"CODE_DUPLICATE"===u.codes[t].error&&(u.codes[t].error="");e.error="",e.validated=!1},u.removeCodeInput=function(e,t){u.codes.splice(t,1),u.leaveUploadInput()},r.$watch(function(){return u.codes},function(e){e.length?u.isValid=e.every(function(e){return!e.error}):(u.anotherCode(),u.isValid=!1)},!0)}e.$inject=["$scope","$rootScope","$injector","SCPHttpService","SCPParams"],angular.module("SCPWidgets").controller("SCPUploadCodeWidget",e)}(),function(){function e(t,e,n,i,a,r,o,s){var l=this;l.firstName=a.userData.firstName,l.lastName=a.userData.lastName,l.isShowAll=!1,l.draws=[],l.codes=null,l.promotionActive=a.promotionActive,n.$on("SCPUploadedCode",function(){l.getCodes()}),n.$on("SCPUpdatedProfile",function(e,t){l.firstName=t.firstName,l.lastName=t.lastName}),n.$on("SCPLogout",function(){o.post("logout").then(function(e){t.location.href=t.location.origin+t.location.pathname})}),l.init=function(){s.hasCSRF()?(l.getCodes(),l.checkShowSubscription(),l.checkShowFinishPassword()):s.initCSRF(function(){l.getCodes(),l.checkShowSubscription(),l.checkShowFinishPassword()})},l.getCodes=function(){l.codes=null,o.post("journal",{promotionId:a.promotionId}).then(function(e){l.codes=l.transformFromJournalToCodes(e.result),l.draws=e.result.drawTypes,i.$broadcast("SCPUpdatedCodes",{codesLength:angular.isArray(l.codes)?l.codes.length:0})})},l.checkShowSubscription=function(){o.post("subscriptions").then(function(e){for(var t=!1,n=e.result,i=0,o=n.length;i<o;i++)n[i].promotionId===a.promotionId&&(t=!0);t||r.open("subscribe",{showClose:!1})})},l.checkShowFinishPassword=function(){"recovery"===a.action&&""===a.message&&r.open("finishPasswordRecovery")},l.transformFromJournalToCodes=function(t){for(var e=[],n=0;n<t.codes.length;n++){var i=t.codes[n],o={code:i.code,uploaded:i.uploaded,drawn:[],hasWinning:!1};if(angular.isArray(i.drawn)&&0===i.drawn.length)for(var a=0;a<t.drawTypes.length;a++)o.drawn.push(null);else for(a=0;a<t.drawTypes.length;a++){var r,s=t.drawTypes[a];i.drawn[s.drawType]?(r=i.drawn[s.drawType],s=Object.keys(t.prizeTypes).find(function(e){return t.prizeTypes[e].prizeTypeIndex===r.prizeTypeId.prizeTypeIndex}),(s=t.prizeTypes[s])&&(o.drawn.push({drawName:r.drawName,drawn:r.drawn,prizeName:s.prizeTypeName,prizeValue:s.prizeTypeValue,image:s.image}),o.hasWinning=!0)):o.drawn.push(null)}e.push(o)}return e},l.openUploadCode=function(e){e.preventDefault(),r.open("uploadCode",{data:{codesLength:l.codes.length}})},l.openUpdateProfile=function(e){e.preventDefault(),r.open("updateProfile")},l.logout=function(e){e.preventDefault(),i.$broadcast("SCPLogout")},l.showAll=function(e){e.preventDefault(),l.isShowAll=!0},l.formatNumberAndCurrency=function(e){return 1e6<=(e=parseInt(e,10))?e/1e6+" millió Ft":e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" Ft"},l.calculatePrizeObtainDeadline=function(e){var e=new Date(e),t=parseInt(a.promotion.prizeObtainDays,10);return isNaN(t)||e.setDate(e.getDate()+t),e.toJSON()}}e.$inject=["$window","$q","$scope","$rootScope","SCPParams","SCPModalService","SCPHttpService","SCPCsrf"],angular.module("SCPWidgets").controller("SCPProfileWidget",e)}(),function(){function e(n,t,i,o){var a=this;a.state=null,n.formButton={},a.init=function(){},a.submitForm=function(e,t){e.preventDefault(),a.errors=null,t&&(n.formButton.enableSpinner(),o.post("subscribe",{Promo_SubscribeRequest:{promotionId:i.promotionId,termsAndConditions:1}}).then(function(){a.state="success",n.formButton.disableSpinner()},function(e){a.errors=e,n.formButton.disableSpinner()}))},a.logout=function(e){e.preventDefault(),t.$broadcast("SCPLogout")},a.closeThisDialog=function(){n.closeThisDialog()}}e.$inject=["$scope","$rootScope","SCPParams","SCPHttpService"],angular.module("SCPWidgets").controller("SCPSubscribeWidget",e)}();