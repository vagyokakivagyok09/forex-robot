# Weekend Ghost Alert Fix Implementation Plan

## Goal
Prevent the app from sending Telegram alerts or showing valid breakout signals when the market is closed (e.g., weekends) by checking if the data is fresh.

## Proposed Changes
### Core Logic ([app.py](file:///c:/Users/Tomi/.gemini/app.py))
#### [MODIFY] [app.py](file:///c:/Users/Tomi/.gemini/app.py)
- **Freshness Check**:
    - Inside [analyze_and_plot](file:///c:/Users/Tomi/.gemini/app.py#70-297), compare `data.index[-1].date()` with `datetime.now().date()`.
    - `is_fresh = last_candle_date == current_date`.
- **Logic Branching**:
    - If `not is_fresh`:
        - Display `st.warning("⚠️ A piac zárva van...")`.
        - Set `breakout_direction = "NEUTRAL"` (or "CLOSED") to prevent line drawing and alerts.
    - If `is_fresh`:
        - Proceed with normal breakout detection.

### Alerts
- Ensure Telegram sending block checks `is_fresh` (implicitly done if `breakout_direction` is neutralized).

## Verification Plan
### Manual Verification
- Run the app on a weekend (or simulate by changing date logic).
- Verify "A piac zárva van" warning appears.
- Verify NO green/red dashed lines are drawn.
- Verify NO Telegram alert is sent.
